\NeedsTeXFormat{LaTeX2e}%
\ProvidesPackage{ECULetter}
\usepackage[letterpaper, hmargin={2in,1in}, vmargin=1in]{geometry}
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{fancyhdr}
\usepackage{lastpage}

% Option bw uses the black and white image for the letterhead.
\newif\if@bw
\@bwfalse

% Below are some options for generating alternate addresses. They are commented because 
% they are no longer in use.
%\newif\if@cof
%\@coffalse
%
%\newif\if@acus
%\@acusfalse


\DeclareOption{bw}{\@bwtrue}
\DeclareOption{color}{\@bwfalse}
%\DeclareOption{cof}{\@coftrue}
%\DeclareOption{acus}{\@acustrue}
\ProcessOptions\relax


\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

% The author's name goes in last set of brackets below.
\newcommand{\theauthor}{Mark W.\ Sprague}

\newif\if@fromdefined
\@fromdefinedfalse

\newif\if@letterdatedefined
\@letterdatedefinedfalse

\newif\if@ptwoheaddefined
\@ptwoheaddefinedfalse

\def\@recipient{\relax} 
\newcommand{\recipient}[1]{\gdef\@recipient{#1}} 

\def\@subject{\relax} 
\newcommand{\subject}[1]{\gdef\@subject{#1}}

\def\@from{\relax} 
\newcommand{\from}[1]{\gdef\@from{#1} \@fromdefinedtrue}

\def\@letterdate{\relax} 
\newcommand{\letterdate}[1]{\gdef\@letterdate{#1} \@letterdatedefinedtrue}

\def\@ptwohead{\relax}
\newcommand{\ptwohead}[1]{\gdef\@ptwohead{#1} \@ptwoheaddefinedtrue}


\newcommand{\iaddress}[1]{
\par
#1
\par
}
\newcommand{\greeting}[1]{
\par
#1
\par
}

\newcommand{\closing}[1]{
\par
\vspace{\parskip}\vspace{\parskip}#1,
\par
\vspace{\parskip}\vspace{\parskip}\theauthor
}

% This command will include a signature image. The absolute path to the signature file must be in the \includegraphics command below.
\newcommand{\closingsig}[1]{
\par
\vspace{\parskip}\vspace{\parskip}#1,\\
\includegraphics[width=1.75in]{/Users/mark/Pictures/MWSSig.pdf}\\
\theauthor
}

% This is the command to include the letterhead in the document.
\newcommand{\letterhead}{
\thispagestyle{plain}
\hspace{-1.75in}
\begin{minipage}[t]{1.7in}
\vspace{-0.5in}
\if@bw
% The absolute path to the black and white ECU logo file must be in the \includegraphics command below.
  \includegraphics[width=4.75in]{/Users/mark/Pictures/ECULogo2010BW.pdf}\\ \\
\else
% The absolute path to the color ECU logo file must be in the \includegraphics command below.
  \includegraphics[width=4.75in]{/Users/mark/Pictures/ECULogo2010.pdf}\\ \\
\fi
{\sf\raggedright \fontsize{9}{10.8}\selectfont \textbf{Mark W.\ Sprague, Ph.D.}\\
% See the alternate address options below. They are commented because they are no longer 
% in use.
%\if@cof
%  ~\\
%  Chair of the Faculty\\
%  Office of the Faculty Senate\\
%  Mail Stop 109\\
%  East Carolina University\\
%  Greenville, NC 27858-4353\\
%  USA\\
%  ~\\
%  252-328-6537 office\\
%  252-328-6122 fax\\
%  ~\\~\\
%\fi
Associate Professor\\
%\if@acus
%  ~\\
%  Assistant Chair for\\
%  Undergraduate Studies\\
%  ~\\
%\fi
Department of Physics\\
Mail Stop 563 \\ 
East Carolina University\\ 
Greenville, NC 27858-4353\\
USA\\~\\
252-328-6739 office\\
252-328-6314 fax\\~\\
spraguem@ecu.edu\\
myweb.ecu.edu/spraguem\\
}
\end{minipage}%
\normalsize
\par
\vspace{-2.07in}
}

% The command memohead creates a heading for a memorandum.
\newcommand{\memohead}{
\begin{tabular}{l l}
\multicolumn{2}{l}{MEMORANDUM}\\ \\
TO: & \@recipient\\ \\
FROM: & 
\if@fromdefined
  \@from\\ \\
\else
  \theauthor\\ \\
\fi
DATE: & 
\if@letterdatedefined
  \@letterdate \\ \\
\else
  \today \\ \\
\fi
SUBJECT: & \@subject\\ \\
\end{tabular}

}

\headsep = 0.25 in
\parskip = 2 ex
\parindent = 0.0in
\footskip = 18pt

\fancypagestyle{plain}{%
\fancyhf{}
\fancyfoot[L]{\hspace{-1.75in}
\begin{minipage}{1.7in}
\raggedright
\emph{\fontsize{7}{8.4}\selectfont East Carolina University is a constituent institution of the University of North Carolina.\\ An equal opportunity university.\\} 
\end{minipage}
}
}

\newenvironment{afterclose}{\begin{description}}{\end{description}}

\newcommand{\ps}{
\item[{\rm{P.S.}}] 
}

\newcommand{\encl}{
\item[{\rm{encl:}}] 
}

\newcommand{\cc}{
\item[{\rm{cc:}}] 
}


\pagestyle{fancy}

\lhead{
  \if@ptwoheaddefined 
    \@ptwohead
  \else
    \theauthor
  \fi
}
\chead{}
\rhead{Page \thepage\ of \pageref{LastPage}}
\lfoot{}
\cfoot{}
\rfoot{}

\raggedright


\endinput
